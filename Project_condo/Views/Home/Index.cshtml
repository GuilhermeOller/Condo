@{
    ViewData["Title"] = "Meus Visitantes";
}
<nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light border-bottom box-shadow mb-4">
    <div class="container-fluid">
        <a class="navbar-brand" asp-area="">
            <i class="fas fa-building"></i>Vivência
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse collapse d-sm-inline-flex justify-content-between">
            <ul class="navbar-nav flex-grow-1">
                <li class="nav-item">
                    <a class="nav-link" asp-area="" asp-controller="Login" asp-action="Index" onclick="logout()">
                        <i class="fas fa-sign-out-alt me-1"></i> Sair
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container mt-4">
    <div id="boasVindas" class="welcome-card mb-4 shadow-sm"></div>

    <div class="d-flex flex-column flex-xxl-row flex-row justify-content-between align-items-start align-items-xxl-center mb-4">
        <h2>Visitantes Cadastrados</h2>
        <div class="d-flex flex-column flex-sm-row gap-2 mt-3 mt-xxl-0">
            <button class="btn btn-success btn-wave mb-2 mb-sm-0" onclick="mostrarFormulario()">
                <i class="fas fa-user-plus me-2"></i>Adicionar Visitante
            </button>
            <button class="btn btn-secondary btn-wave mb-2 mb-sm-0" onclick="carregarAcessosEmAberto()">
                <i class="fas fa-list me-2"></i>Ver Acessos em aberto
            </button>
            <button class="btn btn-purple btn-wave" onclick="carregarFestas()">
                <i class="fas fa-users me-2"></i> Modo Festa
            </button>
        </div>
    </div>

    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4" id="visitantesCards"></div>

    <!-- Modal Acessos em Aberto -->
    <div class="modal fade" id="modalAcessos" tabindex="-1" aria-labelledby="modalAcessosLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-list me-2"></i>Acessos em Aberto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                    <div class="row" id="acessosCards"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Festas -->
    <div class="modal fade" id="modalFestas" tabindex="-1" aria-labelledby="modalFestasLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-users me-2"></i>Festas cadastradas</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                    <div class="row" id="festasCards"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary" onclick="carregarCadastroFesta()">
                        <i class="fas fa-plus me-1"></i> Cadastrar uma festa
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Período de Acesso -->
    <div class="modal fade" id="periodoAcesso" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-calendar-alt me-2"></i>Período do Acesso</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="formPeriodoAcesso">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">ID: <span class="text-primary-custom" id="idPeriodoAcesso"></span></label>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Nome: <span class="text-primary-custom" id="nomeVisitante"></span></label>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="de" class="form-label">Data Inicial</label>
                                <input type="date" class="form-control" id="de" required />
                            </div>
                            <div class="col-md-4">
                                <label for="horasDe" class="form-label">Horário</label>
                                <input type="time" class="form-control" id="horasDe" required />
                            </div>
                            <div class="col-md-4 d-flex align-items-end">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="diaTodoDe">
                                    <label class="form-check-label" for="diaTodoDe">Dia todo</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <label for="ate" class="form-label">Data Final</label>
                                <input type="date" class="form-control" id="ate" required />
                            </div>
                            <div class="col-md-4">
                                <label for="horasAte" class="form-label">Horário</label>
                                <input type="time" class="form-control" id="horasAte" required />
                            </div>
                            <div class="col-md-4 d-flex align-items-end">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="diaTodoAte">
                                    <label class="form-check-label" for="diaTodoAte">Dia todo</label>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-1"></i> Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="liberarVisitanteComPeriodo()">
                        <i class="fas fa-check me-1"></i> Liberar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Adicionar Festa -->
    <div class="modal fade" id="adicionarFesta" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-calendar-plus me-2"></i>Cadastrar Festa</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                    <form id="formCadastroFesta">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="nomeFesta" class="form-label">Nome da Festa</label>
                                <input type="text" class="form-control" id="nomeFesta" placeholder="Digite o nome da festa" />
                            </div>
                            <div class="col-md-6">
                                <label for="fotoConvite" class="form-label">Anexar convite (opcional)</label>
                                <input type="file" class="form-control" id="fotoConvite" accept="image/*" />
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="viaZap">
                                    <label class="form-check-label" for="viaZap">Enviar por WhatsApp</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="viaEmail">
                                    <label class="form-check-label" for="viaEmail">Enviar por Email</label>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="dataInicio" class="form-label">Data Inicial</label>
                                <input type="date" class="form-control" id="dataInicio" />
                            </div>
                            <div class="col-md-4">
                                <label for="horaInicio" class="form-label">Horário</label>
                                <input type="time" class="form-control" id="horaInicio" />
                            </div>
                            <div class="col-md-4 d-flex align-items-end">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="diaTodoInicio">
                                    <label class="form-check-label" for="diaTodoInicio">Dia todo</label>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-4">
                            <div class="col-md-4">
                                <label for="dataFim" class="form-label">Data Final</label>
                                <input type="date" class="form-control" id="dataFim" />
                            </div>
                            <div class="col-md-4">
                                <label for="horaFim" class="form-label">Horário</label>
                                <input type="time" class="form-control" id="horaFim" />
                            </div>
                            <div class="col-md-4 d-flex align-items-end">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="diaTodoFim">
                                    <label class="form-check-label" for="diaTodoFim">Dia todo</label>
                                </div>
                            </div>
                        </div>
                        <hr class="my-4" />
                        <h5><i class="fas fa-users me-2"></i>Selecionar Visitantes</h5>
                        <div class="table-responsive mt-3">
                            <table class="table table-bordered table-hover">
                                <thead class="table-light">
                                    <tr>
                                        <th>Selecionar</th>
                                        <th>Nome</th>
                                        <th>Documento</th>
                                        <th>Celular</th>
                                    </tr>
                                </thead>
                                <tbody id="tabelaVisitantesFesta">
                                </tbody>
                            </table>
                            <button type="button" class="btn btn-secondary btn-wave mt-3" onclick="mostrarFormulario()">
                                <i class="fas fa-user-plus me-2"></i>Cadastrar novo visitante
                            </button>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-1"></i> Cancelar
                    </button>
                    <button type="button" class="btn btn-success" onclick="salvarFesta()">
                        <i class="fas fa-check me-1"></i> Salvar Festa
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Atualizar Festa -->
    <div class="modal fade" id="atualizarFesta" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-calendar-plus me-2"></i>Atualizar Festa</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                    <form id="formEditarFesta">
                        <input type="hidden" id="editIdFesta">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="editNomeFesta" class="form-label">Nome da Festa</label>
                                <input type="text" class="form-control" id="editNomeFesta" placeholder="Digite o nome da festa" />
                            </div>
                            <div class="col-md-6">
                                <label for="editFotoConvite" class="form-label">Anexar convite (opcional)</label>
                                <input type="file" class="form-control" id="editFotoConvite" accept="image/*" />
                                <img id="previewFotoConvite" src="" alt="Convite atual" class="img-preview" style="display: none;" />
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="editViaZap">
                                    <label class="form-check-label" for="editViaZap">Enviar por WhatsApp</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="editViaEmail">
                                    <label class="form-check-label" for="editViaEmail">Enviar por Email</label>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="editDataInicio" class="form-label">Data Inicial</label>
                                <input type="date" class="form-control" id="editDataInicio" />
                            </div>
                            <div class="col-md-4">
                                <label for="editHoraInicio" class="form-label">Horário</label>
                                <input type="time" class="form-control" id="editHoraInicio" />
                            </div>
                            <div class="col-md-4 d-flex align-items-end">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="editDiaTodoInicio">
                                    <label class="form-check-label" for="editDiaTodoInicio">Dia todo</label>
                                </div>
                            </div>
                        </div>
                        <div class="row mb-4">
                            <div class="col-md-4">
                                <label for="editDataFim" class="form-label">Data Final</label>
                                <input type="date" class="form-control" id="editDataFim" />
                            </div>
                            <div class="col-md-4">
                                <label for="editHoraFim" class="form-label">Horário</label>
                                <input type="time" class="form-control" id="editHoraFim" />
                            </div>
                            <div class="col-md-4 d-flex align-items-end">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="editDiaTodoFim">
                                    <label class="form-check-label" for="editDiaTodoFim">Dia todo</label>
                                </div>
                            </div>
                        </div>
                        <hr class="my-4" />
                        <h5><i class="fas fa-users me-2"></i>Selecionar Visitantes</h5>
                        <div class="table-responsive mt-3">
                            <table class="table table-bordered table-hover">
                                <thead class="table-light">
                                    <tr>
                                        <th>Selecionar</th>
                                        <th>Nome</th>
                                        <th>Documento</th>
                                        <th>Celular</th>
                                    </tr>
                                </thead>
                                <tbody id="editTabelaVisitantesFesta">
                                </tbody>
                            </table>
                            <button type="button" class="btn btn-secondary btn-wave mt-3" onclick="mostrarFormulario()">
                                <i class="fas fa-user-plus me-2"></i>Cadastrar novo visitante
                            </button>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-1"></i> Cancelar
                    </button>
                    <button type="button" class="btn btn-success" onclick="salvarEdicaoFesta()">
                        <i class="fas fa-check me-1"></i> Salvar Alterações
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Editar Visitante -->
    <div class="modal fade" id="editarVisitanteModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-user-edit me-2"></i>Editar Visitante</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="formEditarVisitante">
                        <input type="hidden" id="editIdVisitante">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="visitante" class="form-label">Nome Completo</label>
                                <input type="text" class="form-control" id="editVisitante" required />
                            </div>
                            <div class="col-md-6">
                                <label for="foneCelular" class="form-label">Telefone Celular</label>
                                <input type="tel" class="form-control" id="editFoneCelular" placeholder="(99) 9999-9999" required />
                            </div>
                            <div class="col-md-6">
                                <label for="email" class="form-label">E-mail*</label>
                                <input type="email" class="form-control" id="editEmail" placeholder="exemplo@dominio.com" required />
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-1"></i> Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="salvarEdicao()">
                        <i class="fas fa-save me-1"></i> Salvar Alterações
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Cadastro de Visitante -->
    <div class="modal fade" id="formularioVisitante" tabindex="-1" data-bs-backdrop="false">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-user-plus me-2"></i>Novo Visitante</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                    <form id="formVisitante" class="row g-3">
                        <div class="col-md-6">
                            <label for="visitante" class="form-label">Nome Completo*</label>
                            <input type="text" class="form-control" id="visitante" required />
                        </div>
                        <div class="col-md-6">
                            <label for="foneCelular" class="form-label">Telefone Celular*</label>
                            <input type="tel" class="form-control" id="foneCelular" placeholder="(99) 9999-9999" required />
                        </div>
                        <div class="col-md-6">
                            <label for="email" class="form-label">E-mail*</label>
                            <input type="email" class="form-control" id="email" placeholder="exemplo@dominio.com" required />
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-1"></i> Cancelar
                    </button>
                    <button type="submit" form="formVisitante" class="btn btn-primary">
                        <i class="fas fa-save me-2"></i> Salvar
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<link rel="stylesheet" href="~/css/home.css">
<script src="~/js/home.js"></script>